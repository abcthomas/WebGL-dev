<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>WebGL Shader Conformance Tests</title>
<link rel="stylesheet" href="../../../../resources/js-test-style.css"/>
<script src="../../../../resources/js-test-pre.js"></script>
<script src="../../../../conformance/resources/webgl-test.js"></script>
<script src="../../../../conformance/resources/webgl-test-utils.js"></script>
<script src="deqp-tests.js"></script>
<script src="glu-draw.js"></script>
<script src="shader-library.js"></script>
<script src="shader-utils.js"></script>
<script src="shader-library-case.js"></script>
</head>
<body>
<div id="description"></div>
<div id="console"></div>
<canvas id="canvas" width="200" height="100"> </canvas>
<script>
testName = "conditionals";
description("Shader test: " + testName + ".");

successfullyParsed = true;


var stateMachine = (function() {
	"use strict";
	var state = [{}];

	var getState = function() {
		return state[state.length - 1];
	};
	
	// TODO: make it clone the previous state on push
	var pushState = function() {
		state.push({});
	};
	
	var popState = function() {
		state.pop();
	};

	var runCallback = function(callback) {
		setTimeout(callback.bind(this), 0);
	};

	var terminate = function(successful) {
		successfullyParsed = successfullyParsed && successful;
		var testPost = document.createElement('script');
		testPost.src = "../../../../resources/js-test-post.js";
		document.body.appendChild(testPost);
	};

	return {
		runCallback: runCallback,
		getState: getState,
		terminate: terminate,
		none: false
	};
	
}());



WebGLTestUtils.loadTextFileAsync(testName + ".test", function(success, content) {
	if (success) {
		stateMachine.getState().testFile = content;
		stateMachine.runCallback(shaderLibrary.processTestFile);
	} else {
		stateMachine.terminate(false);
	}
});

</script>
</body>
</html>
